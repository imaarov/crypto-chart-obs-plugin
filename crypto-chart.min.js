const urlParams=new URLSearchParams(window.location.search),coin=urlParams.get("coin")||"bitcoin",theme=urlParams.get("theme")||"dark",range=urlParams.get("range")||"day";"dark"===theme?(document.documentElement.style.setProperty("--card-bg","#2b2b3c"),document.documentElement.style.setProperty("--text-color","#ffffff"),document.documentElement.style.setProperty("--price-color","#00cc99")):"light"===theme&&(document.documentElement.style.setProperty("--card-bg","#ffffff"),document.documentElement.style.setProperty("--text-color","#333333"),document.documentElement.style.setProperty("--price-color","#007acc"));const ctx=document.getElementById("priceChart").getContext("2d"),priceChart=new Chart(ctx,{type:"line",data:{labels:[],datasets:[{label:`${coin.charAt(0).toUpperCase()+coin.slice(1)} Price (USD)`,backgroundColor:"dark"===theme?"rgba(255, 99, 132, 0.2)":"rgba(54, 162, 235, 0.2)",borderColor:"dark"===theme?"rgba(255, 99, 132, 1)":"rgba(54, 162, 235, 1)",data:[],pointRadius:0,fill:!1}]},options:{responsive:!0,scales:{x:{type:"time",time:{unit:"day"===range?"hour":"week"===range?"day":"month",displayFormats:{hour:"HH:mm",day:"MMM d",month:"MMM yyyy"}},ticks:{maxTicksLimit:6},title:{display:!0,text:"Time",color:"var(--text-color)"}},y:{title:{display:!0,text:"Price (USD)",color:"var(--text-color)"},beginAtZero:!1}},plugins:{legend:{labels:{color:"var(--text-color)"}}}}});async function fetchPriceData(){try{const e=await fetch(`https://api.coingecko.com/api/v3/coins/${coin}/market_chart?vs_currency=usd&days=${"day"===range?1:"week"===range?7:"month"===range?30:365}`),t=(await e.json()).prices.map((e=>({time:new Date(e[0]),price:e[1]})));priceChart.data.labels=t.map((e=>e.time)),priceChart.data.datasets[0].data=t.map((e=>e.price)),priceChart.update();const c=t[t.length-1].price;document.getElementById("current-price").textContent=`$${c.toFixed(2)}`}catch(e){console.error("Error fetching price data:",e)}}async function fetchCoinIcon(){try{const e=await fetch(`https://api.coingecko.com/api/v3/coins/${coin}`),t=(await e.json()).image.small;document.getElementById("icon-img").src=t}catch(e){console.error("Error fetching coin icon:",e),document.getElementById("icon-img").alt="Icon not found"}}fetchPriceData(),fetchCoinIcon(),"day"===range&&setInterval(fetchPriceData,1e4);
